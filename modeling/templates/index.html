<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flight Delay Prediction</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Rechercher des Vols</h1>
        <form id="search-form" class="mt-3">
            <div class="form-group">
                <label for="departure-city">Ville de départ</label>
                <input type="text" id="departure-city" class="form-control" placeholder="Entrez la ville de départ">
            </div>
            <div class="form-group">
                <label for="destination">Destination</label>
                <input type="text" id="destination" class="form-control" placeholder="Entrez la destination">
            </div>
            <div class="form-group">
                <label for="start-date">Date de début</label>
                <input type="date" id="start-date" class="form-control">
            </div>
            <div class="form-group">
                <label for="end-date">Date de fin</label>
                <input type="date" id="end-date" class="form-control">
            </div>
            <button type="submit" class="btn btn-primary">Rechercher</button>
        </form>

        <h2 class="mt-5">Résultats</h2>
        <table class="table table-striped" id="results-table">
            <thead>
                <tr>
                    <th>From</th>
                    <th>To</th>
                    <th>Aircraft</th>
                    <th>Flight Time</th>
                    <th>STD</th>
                    <th>ATD</th>
                    <th>STA</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <!-- Results will be appended here -->
            </tbody>
        </table>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>
        $(document).ready(function() {
            $('#search-form').on('submit', function(event) {
                event.preventDefault();

                const formData = {
                    'departure-city': $('#departure-city').val(),
                    'destination': $('#destination').val(),
                    'start-date': $('#start-date').val(),
                    'end-date': $('#end-date').val()
                };

                $.get('/search', formData, function(data) {
                    const tableBody = $('#results-table tbody');
                    tableBody.empty();

                    data.forEach(function(flight) {
                        const row = `<tr>
                            <td>${flight.from_city}</td>
                            <td>${flight.to_city}</td>
                            <td>${flight.aircraft}</td>
                            <td>${flight.flight_time} hours</td>
                            <td>${flight.scheduled_time_departure}</td>
                            <td>${flight.actual_time_departure}</td>
                            <td>${flight.scheduled_time_arrival}</td>
                            <td>${flight.status}</td>
                        </tr>`;
                        tableBody.append(row);
                    });
                }).fail(function(jqXHR, textStatus, errorThrown) {
                    console.error('Error fetching flight data:', textStatus, errorThrown);
                });
            });
        });
    </script>
</body>
</html>
